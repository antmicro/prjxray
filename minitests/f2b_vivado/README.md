# Utility to run different flows through fasm2bels



This utility scripts are useful to run the following flow:

1. Yosys+Vivado -> fasm2bels -> Vivado
2. SymbiFlow -> fasm2bels -> Vivado

## Prerequisites

`XRAY_PART` env variable must be exported with the exact part that is meant for the design
`ARCH_DEFS_DIRECTORY` env variable must be exported to point to the root location of the SymbiFlow-arch-defs directory

SymbiFlow arch defs must have the channels.db compiled as it is needed by fasm2bels:
```
${ARCH_DEFS_DIRECTORY}/build/xc7/archs/artix7/devices/xc7a50t-virt/channels.db
```

There may be issues with the verilog generated by fasm2bels, related to impossible CLK inversion. To solve these, apply the following commit to fasm2bels:

```
https://github.com/SymbiFlow/symbiflow-arch-defs/pull/1313/commits/1ff277caeb6c39da9238b969033ecf307b8005f0
```

## How to run

It is advised to get all the source files in a single directory within this utility.
For now, there already is an example directory containing the `ddr_uart` test.

To run the first flow, do the following:

```
./f2b_vivado.py --pcf ddr_uart/arty.pcf --xdc ddr_uart/top.xdc --source_dir ddr_uart --top_verilog top.v
```

To run the second flow. do the following:

```
./f2b_vivado.py --pcf ddr_uart/arty.pcf --xdc ddr_uart/top.xdc --fasm <path_to_fasm> --eblif <path_to_eblif>
```
